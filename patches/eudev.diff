--- eudev-3.2.1/rules/80-drivers.rules.orig	2017-01-24 11:00:53.174192908 +0200
+++ eudev-3.2.1/rules/80-drivers.rules	2017-01-24 11:04:01.886714118 +0200
@@ -8,6 +8,7 @@
 SUBSYSTEM=="memstick", RUN{builtin}+="kmod load ms_block mspro_block"
 SUBSYSTEM=="i2o", RUN{builtin}+="kmod load i2o_block"
 SUBSYSTEM=="module", KERNEL=="parport_pc", RUN{builtin}+="kmod load ppdev"
+SUBSYSTEM=="graphics", RUN{builtin}+="kmod load fbcon"
 KERNEL=="mtd*ro", ENV{MTD_FTL}=="smartmedia", RUN{builtin}+="kmod load sm_ftl"
 
 LABEL="drivers_end"
diff --git a/src/udev/udev-event.c b/src/udev/udev-event.c
index d0befba29..790498c97 100644
--- a/src/udev/udev-event.c
+++ b/src/udev/udev-event.c
@@ -855,6 +855,11 @@ void udev_event_execute_rules(struct udev_event *event,
         if (udev_device_get_subsystem(dev) == NULL)
                 return;
 
+        if (streq(udev_device_get_action(dev), "bind") || streq(udev_device_get_action(dev), "unbind")) {
+            // Ignore bind/unbind events
+            return;
+        }
+
         if (streq(udev_device_get_action(dev), "remove")) {
                 udev_device_read_db(dev);
                 udev_device_tag_index(dev, NULL, false);

--- ./rules/50-udev-default.rules.orig	2023-05-16 10:08:56.000000000 -0500
+++ ./rules/50-udev-default.rules	2023-05-16 13:15:25.690216651 -0500
@@ -31,12 +31,12 @@
 
 SUBSYSTEM=="video4linux", GROUP="video"
 SUBSYSTEM=="graphics", GROUP="video"
-SUBSYSTEM=="drm", KERNEL!="renderD*", GROUP="video"
+SUBSYSTEM=="drm", GROUP="video"
 SUBSYSTEM=="dvb", GROUP="video"
 SUBSYSTEM=="media", GROUP="video"
 SUBSYSTEM=="cec", GROUP="video"
 
-SUBSYSTEM=="drm", KERNEL=="renderD*", GROUP="video", MODE="0666"
+SUBSYSTEM=="drm", GROUP="video", MODE="0666"
 SUBSYSTEM=="kfd", GROUP="video", MODE="0666"
 
 SUBSYSTEM=="misc", KERNEL=="sgx_enclave", GROUP="sgx", MODE="0660"
--- ./rules/50-udev-default.rules.orig	2023-05-16 10:08:56.000000000 -0500
+++ ./rules/50-udev-default.rules	2023-05-17 12:45:42.392847645 -0500
@@ -39,8 +39,9 @@
 SUBSYSTEM=="drm", KERNEL=="renderD*", GROUP="video", MODE="0666"
 SUBSYSTEM=="kfd", GROUP="video", MODE="0666"
 
-SUBSYSTEM=="misc", KERNEL=="sgx_enclave", GROUP="sgx", MODE="0660"
-SUBSYSTEM=="misc", KERNEL=="sgx_vepc", GROUP="sgx", MODE="0660"
+# This is obsolete. No sense starting to support it now.
+#SUBSYSTEM=="misc", KERNEL=="sgx_enclave", GROUP="sgx", MODE="0660"
+#SUBSYSTEM=="misc", KERNEL=="sgx_vepc", GROUP="sgx", MODE="0660"
 
 # When using static_node= with non-default permissions, also update
 # tmpfiles.d/static-nodes-permissions.conf.in to keep permissions synchronized.
From 917ae648f61681257000c3a1f0aca3fbd646563a Mon Sep 17 00:00:00 2001
From: Johannes Nixdorf <mixi@shadowice.org>
Date: Fri, 22 Dec 2023 10:27:08 +0100
Subject: [PATCH] 78-sound-card.rules: Import ID_PATH early

Pipewire requires ID_PATH to use the same device names as with systemd's
udev. Some rules, such as the ones in asahi-audio [1] use those names, and
fail if they don't match [2].

On systemd's udev this is instead imported in 71-seat.rules, which we don't
have.

[1]: https://github.com/AsahiLinux/asahi-audio
[2]: https://github.com/AsahiLinux/asahi-audio/issues/16

Signed-off-by: Johannes Nixdorf <mixi@shadowice.org>
---
 rules/78-sound-card.rules | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)

diff --git a/rules/78-sound-card.rules b/rules/78-sound-card.rules
index f2fc27739..c49bd1d4e 100644
--- a/rules/78-sound-card.rules
+++ b/rules/78-sound-card.rules
@@ -38,6 +38,8 @@ KERNEL!="card*", GOTO="sound_end"
 ENV{SOUND_INITIALIZED}="1"
 
 IMPORT{builtin}="hwdb"
+IMPORT{builtin}="path_id"
+
 SUBSYSTEMS=="usb", IMPORT{builtin}="usb_id"
 SUBSYSTEMS=="usb", GOTO="skip_pci"
 
@@ -62,8 +64,6 @@ LABEL="skip_pci"
 ENV{ID_SERIAL}=="?*", ENV{ID_USB_INTERFACE_NUM}=="?*", ENV{ID_ID}="$env{ID_BUS}-$env{ID_SERIAL}-$env{ID_USB_INTERFACE_NUM}"
 ENV{ID_SERIAL}=="?*", ENV{ID_USB_INTERFACE_NUM}=="", ENV{ID_ID}="$env{ID_BUS}-$env{ID_SERIAL}"
 
-IMPORT{builtin}="path_id"
-
 # The values used here for $SOUND_FORM_FACTOR and $SOUND_CLASS should be kept
 # in sync with those defined for PulseAudio's src/pulse/proplist.h
 # PA_PROP_DEVICE_FORM_FACTOR, PA_PROP_DEVICE_CLASS properties.
